(self.webpackChunkclips=self.webpackChunkclips||[]).push([[829],{3327:(A,w,l)=>{"use strict";l.r(w),l.d(w,{defaultOptions:()=>v,fetchFile:()=>Q,getCreateFFmpegCore:()=>f});const v={corePath:`https://unpkg.com/@ffmpeg/core@${l(3681).devDependencies["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`};var C=l(5861),e=l(6945),j=l(3630);const L=function(){var Y=(0,C.Z)(function*(y,S){(0,e.log)("info",`fetch ${y}`);const h=yield(yield fetch(y)).arrayBuffer();(0,e.log)("info",`${y} file size = ${h.byteLength} bytes`);const F=new Blob([h],{type:S}),R=URL.createObjectURL(F);return(0,e.log)("info",`${y} blob URL = ${R}`),R});return function(S,h){return Y.apply(this,arguments)}}(),f=function(){var Y=(0,C.Z)(function*({corePath:y,workerPath:S,wasmPath:h}){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){if("string"!=typeof y)throw Error("corePath should be a string!");const $=new URL(y,"file:///D:/SourceCdoe/angular/clips/node_modules/@ffmpeg/ffmpeg/src/browser/getCreateFFmpegCore.js").href,Z=yield L($,"application/javascript"),G=yield L(void 0!==h?h:$.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),k=yield L(void 0!==S?S:$.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(V=>{if(globalThis.importScripts(Z),typeof createFFmpegCore>"u")throw Error((0,j.CREATE_FFMPEG_CORE_IS_NOT_DEFINED)($));(0,e.log)("info","ffmpeg-core.js script loaded"),V({createFFmpegCore,corePath:Z,wasmPath:G,workerPath:k})}):((0,e.log)("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:Z,wasmPath:G,workerPath:k}))}if("string"!=typeof y)throw Error("corePath should be a string!");const F=new URL(y,"file:///D:/SourceCdoe/angular/clips/node_modules/@ffmpeg/ffmpeg/src/browser/getCreateFFmpegCore.js").href,R=yield L(F,"application/javascript"),D=yield L(void 0!==h?h:F.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),I=yield L(void 0!==S?S:F.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise($=>{const Z=document.createElement("script"),G=()=>{if(Z.removeEventListener("load",G),typeof createFFmpegCore>"u")throw Error((0,j.CREATE_FFMPEG_CORE_IS_NOT_DEFINED)(F));(0,e.log)("info","ffmpeg-core.js script loaded"),$({createFFmpegCore,corePath:R,wasmPath:D,workerPath:I})};Z.src=R,Z.type="text/javascript",Z.addEventListener("load",G),document.getElementsByTagName("head")[0].appendChild(Z)}):((0,e.log)("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:R,wasmPath:D,workerPath:I}))});return function(S){return Y.apply(this,arguments)}}(),Q=function(){var Y=(0,C.Z)(function*(y){let S=y;return typeof y>"u"?new Uint8Array:("string"==typeof y?S=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(y)?atob(y.split(",")[1]).split("").map(h=>h.charCodeAt(0)):yield(yield fetch(new URL(y,"file:///D:/SourceCdoe/angular/clips/node_modules/@ffmpeg/ffmpeg/src/browser/fetchFile.js").href)).arrayBuffer():(y instanceof File||y instanceof Blob)&&(S=yield(Y=>new Promise((y,S)=>{const h=new FileReader;h.onload=()=>{y(h.result)},h.onerror=({target:{error:{code:F}}})=>{S(Error(`File could not be read! Code=${F}`))},h.readAsArrayBuffer(Y)}))(y)),new Uint8Array(S))});return function(S){return Y.apply(this,arguments)}}()},6151:A=>{A.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},9639:(A,w,l)=>{var x=l(7156).default;const{defaultArgs:b,baseOptions:v}=l(6151),C=l(8333),{defaultOptions:e,getCreateFFmpegCore:j}=l(3327),{version:L}=l(3681),f=Error("ffmpeg.wasm is not ready, make sure you have completed load().");A.exports=(J={})=>{const{log:Q,logger:Y,progress:y,...S}={...v,...e,...J};let h=null,F=null,R=null,D=null,I=!1,$=()=>{},Z=Q,G=y,k=0,V=0,T=!1,W=0;const H=(u,g)=>{$({type:u,message:g}),Z&&console.log(`[${u}] ${g}`)},z=u=>{const[g,m,E]=u.split(":");return 60*parseFloat(g)*60+60*parseFloat(m)+parseFloat(E)},K=({type:u,message:g})=>{H(u,g),((u,g)=>{if("string"==typeof u)if(u.startsWith("  Duration")){const m=u.split(", ")[0].split(": ")[1],E=z(m);g({duration:E,ratio:W}),(0===k||k>E)&&(k=E,T=!0)}else if(T&&u.startsWith("    Stream")){const m=u.match(/([\d.]+) fps/);if(m){const E=parseFloat(m[1]);V=k*E}else V=0;T=!1}else if(u.startsWith("frame")||u.startsWith("size")){const m=u.split("time=")[1].split(" ")[0],E=z(m),B=u.match(/frame=\s*(\d+)/);if(V&&B){const M=parseFloat(B[1]);W=Math.min(M/V,1)}else W=E/k;g({ratio:W,time:E})}else u.startsWith("video:")&&(g({ratio:1}),k=0)})(g,G),(u=>{"FFMPEG_END"===u&&null!==R&&(R(),R=null,D=null,I=!1)})(g)},re=function(){var u=x(function*(){if(H("info","load ffmpeg-core"),null!==h)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{H("info","loading ffmpeg-core");const{createFFmpegCore:g,corePath:m,workerPath:E,wasmPath:B}=yield j(S);h=yield g({mainScriptUrlOrBlob:m,printErr:M=>K({type:"fferr",message:M}),print:M=>K({type:"ffout",message:M}),locateFile:(M,ie)=>{if(typeof window<"u"||typeof WorkerGlobalScope<"u"){if(typeof B<"u"&&M.endsWith("ffmpeg-core.wasm"))return B;if(typeof E<"u"&&M.endsWith("ffmpeg-core.worker.js"))return E}return ie+M}}),F=h.cwrap(S.mainName||"proxy_main","number",["number","number"]),H("info","ffmpeg-core loaded")}});return function(){return u.apply(this,arguments)}}();return H("info",`use ffmpeg.wasm v${L}`),{setProgress:u=>{G=u},setLogger:u=>{$=u},setLogging:u=>{Z=u},load:re,isLoaded:()=>null!==h,run:(...u)=>{if(H("info",`run ffmpeg command: ${u.join(" ")}`),null===h)throw f;if(I)throw Error("ffmpeg.wasm can only run one command at a time");return I=!0,new Promise((g,m)=>{const E=[...b,...u].filter(B=>0!==B.length);R=g,D=m,F(...C(h,E))})},exit:()=>{if(null===h)throw f;D&&D("ffmpeg has exited"),I=!1;try{h.exit(1)}catch(u){H(u.message),D&&D(u)}finally{h=null,F=null,R=null,D=null}},FS:(u,...g)=>{if(H("info",`run FS.${u} ${g.map(m=>"string"==typeof m?m:`<${m.length} bytes binary file>`).join(" ")}`),null===h)throw f;{let m=null;try{m=h.FS[u](...g)}catch{throw Error("readdir"===u?`ffmpeg.FS('readdir', '${g[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:"readFile"===u?`ffmpeg.FS('readFile', '${g[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return m}}}}},260:(A,w,l)=>{l(7854);const x=l(9639),{fetchFile:b}=l(3327);A.exports={createFFmpeg:x,fetchFile:b}},3630:A=>{A.exports={CREATE_FFMPEG_CORE_IS_NOT_DEFINED:l=>`\ncreateFFmpegCore is not defined. ffmpeg.wasm is unable to find createFFmpegCore after loading ffmpeg-core.js from ${l}. Use another URL when calling createFFmpeg():\n\nconst ffmpeg = createFFmpeg({\n  corePath: 'http://localhost:3000/ffmpeg-core.js',\n});\n`}},6945:A=>{let w=!1,l=()=>{};A.exports={logging:w,setLogging:C=>{w=C},setCustomLogger:C=>{l=C},log:(C,e)=>{l({type:C,message:e}),w&&console.log(`[${C}] ${e}`)}}},8333:A=>{A.exports=(w,l)=>{const x=w._malloc(l.length*Uint32Array.BYTES_PER_ELEMENT);return l.forEach((b,v)=>{const C=w.lengthBytesUTF8(b)+1,e=w._malloc(C);w.stringToUTF8(b,e,C),w.setValue(x+Uint32Array.BYTES_PER_ELEMENT*v,e,"i32")}),[l.length,x]}},1829:(A,w,l)=>{"use strict";l.r(w),l.d(w,{VideoModule:()=>Fe});var x=l(6895),b=l(9062),v=l(5861),C=l(1135),e=l(4650),j=l(9905),L=l(1609),f=l(4006),J=l(3446),Q=l(235),Y=l(8549);function y(r,s){if(1&r&&(e.TgZ(0,"app-alert",8)(1,"p"),e._uU(2),e.qZA()()),2&r){const t=e.oxw();e.Q6J("color",t.alertColor),e.xp6(2),e.Oqu(t.alertMsg)}}const S=function(r,s){return{"opacity-50":r,"hover:bg-indigo-700":s}};let h=(()=>{class r{constructor(t,i){this.modalService=t,this.clipService=i,this.activeClip=null,this.update=new e.vpe,this.inSubmission=!1,this.showAlert=!1,this.alertColor="blue",this.alertMsg="Please wait! Updaing clip",this.clipID=new f.NI("",{nonNullable:!0}),this.title=new f.NI("",{validators:[f.kI.required,f.kI.minLength(3)],nonNullable:!0}),this.editForm=new f.cw({title:this.title})}ngOnChanges(t){!this.activeClip||(this.clipID.setValue(this.activeClip.docID),this.title.setValue(this.activeClip.title),this.inSubmission=!1,this.showAlert=!1)}ngOnInit(){this.modalService.register("editClip")}ngOnDestroy(){this.modalService.unregister("editClip")}submit(){var t=this;return(0,v.Z)(function*(){if(t.activeClip){t.inSubmission=t.showAlert=!0,t.alertColor="blue",t.alertMsg="Please wait! Updaing clip";try{yield t.clipService.updateClicp(t.clipID.value,t.title.value)}catch{return t.inSubmission=!1,t.alertColor="red",void(t.alertMsg="Something went wrong. Try again later")}t.activeClip.title=t.title.value,t.update.emit(t.activeClip),t.inSubmission=!1,t.alertColor="green",t.alertMsg="Success !w"}})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(L.Z),e.Y36(j.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],inputs:{activeClip:"activeClip"},outputs:{update:"update"},features:[e.TTD],decls:10,vars:8,consts:[["modalID","editClip"],["heading","",1,"text-2xl","font-bold"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mt-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none",3,"disabled","ngClass"],[3,"color"]],template:function(t,i){1&t&&(e.TgZ(0,"app-modal",0)(1,"p",1),e._uU(2,"Edit Video"),e.qZA(),e.YNc(3,y,3,2,"app-alert",2),e.TgZ(4,"form",3),e.NdJ("ngSubmit",function(){return i.submit()}),e.TgZ(5,"div",4),e._UZ(6,"app-input",5),e.qZA(),e.TgZ(7,"div",6)(8,"button",7),e._uU(9," Publish "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",i.showAlert),e.xp6(1),e.Q6J("formGroup",i.editForm),e.xp6(2),e.Q6J("control",i.title),e.xp6(2),e.Q6J("disabled",i.inSubmission)("ngClass",e.WLB(5,S,i.inSubmission,!i.inSubmission)))},dependencies:[x.mk,x.O5,J.z,Q.a,Y.w,f._Y,f.JL,f.sg]}),r})();const F=function(r,s){return["/",r,s]};function R(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"div",10)(1,"a",11),e._UZ(2,"img",12),e.qZA(),e.TgZ(3,"div",13)(4,"a",14),e._uU(5),e.qZA(),e.TgZ(6,"a",15),e.NdJ("click",function(c){const N=e.CHM(t).$implicit,P=e.oxw();return e.KtG(P.copyToClipboard(c,N.docID))}),e._uU(7," Copy Link "),e.qZA()(),e.TgZ(8,"div",16)(9,"a",17),e.NdJ("click",function(c){const N=e.CHM(t).$implicit,P=e.oxw();return e.KtG(P.openModal(c,N))}),e.TgZ(10,"span",18),e._uU(11,"build"),e.qZA()(),e.TgZ(12,"a",19),e.NdJ("click",function(c){const N=e.CHM(t).$implicit,P=e.oxw();return e.KtG(P.deleteClip(c,N))}),e.TgZ(13,"span",18),e._uU(14,"delete"),e.qZA()()()()}if(2&r){const t=s.$implicit;e.xp6(2),e.Q6J("src",t.screenshotURL,e.LSH),e.xp6(2),e.Q6J("routerLink",e.WLB(3,F,t,t.docID)),e.xp6(1),e.hij(" ",t.title," ")}}let D=(()=>{class r{constructor(t,i,c,_){this.router=t,this.route=i,this.clipServer=c,this.modalService=_,this.videoOrder="1",this.clips=[],this.activeClip=null,this.sort$=new C.X(this.videoOrder)}ngOnInit(){this.route.queryParams.subscribe(t=>{this.videoOrder="2"===t.sort?t.sort:"1",this.sort$.next(this.videoOrder)}),this.clipServer.getUserClips(this.sort$).subscribe(t=>{this.clips=[],t.forEach(i=>{this.clips.push({docID:i.id,...i.data()})})})}sort(t){const{value:i}=t.target;this.router.navigate([],{relativeTo:this.route,queryParams:{sort:i}})}openModal(t,i){t.preventDefault(),this.activeClip=i,this.modalService.toggleModal("editClip")}update(t){let i=this.clips.find(c=>c.docID===t.docID);i&&(i.fileName=t.fileName)}deleteClip(t,i){t.preventDefault(),this.clipServer.deleteClip(i);const c=this.clips.indexOf(i);c&&this.clips.splice(c,1)}copyToClipboard(t,i){return(0,v.Z)(function*(){if(t.preventDefault(),!i)return;const c=`${location.origin}/clip/${i}`;yield navigator.clipboard.writeText(c),alert("Link Copied!")})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(b.F0),e.Y36(b.gz),e.Y36(j.Y),e.Y36(L.Z))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-manage"]],decls:13,vars:4,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","justify-between"],["routerLink","/upload",1,"bg-indigo-400","text-white","py-4","px-10","text-xl"],[1,"text-black","px-8","text-xl","outline-none","appearance-none",3,"change"],["value","1",3,"selected"],["value","2",3,"selected"],[1,"container","mx-auto","my-8"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","mt-6 rounded-tl-2xl rounded-br-2xl shadow-xl bg-secondary flex flex-col justify-start",4,"ngFor","ngForOf"],[3,"activeClip","update"],[1,"mt-6","rounded-tl-2xl","rounded-br-2xl","shadow-xl","bg-secondary","flex","flex-col","justify-start"],["href","#"],["crossorigin","",1,"card-img-top","rounded-tl-2xl","w-full",3,"src"],[1,"p-6","text-2xl"],[1,"font-bold","mb-2",3,"routerLink"],["href","#",1,"bg-gray-400","text-white","px-2","py-1","ml-2","text-sm","rounded",3,"click"],[1,"flex","text-center","text-2xl","bg-gray-800","p-2","mt-auto"],["href","#",1,"flex-1","p-2","border-right","border-r-2","border-gray-700","transition","hover:text-indigo-400",3,"click"],[1,"material-icons","text-base"],["href","#",1,"flex-1","p-2","rounded-br-2xl","transition","hover:text-indigo-400",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"a",2),e._uU(3,"Upload Videos"),e.qZA(),e.TgZ(4,"select",3),e.NdJ("change",function(_){return i.sort(_)}),e.TgZ(5,"option",4),e._uU(6,"Recent Uploads"),e.qZA(),e.TgZ(7,"option",5),e._uU(8,"Oldest Uploads"),e.qZA()()()(),e.TgZ(9,"div",6)(10,"div",7),e.YNc(11,R,15,6,"div",8),e.qZA()(),e.TgZ(12,"app-edit",9),e.NdJ("update",function(_){return i.update(_)}),e.qZA()),2&t&&(e.xp6(5),e.Q6J("selected","1"===i.videoOrder),e.xp6(2),e.Q6J("selected","2"===i.videoOrder),e.xp6(4),e.Q6J("ngForOf",i.clips),e.xp6(1),e.Q6J("activeClip",i.activeClip))},dependencies:[x.sg,b.yS,f.YN,f.Kr,h]}),r})();var I=l(3900);const Z={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let G;const k=new Uint8Array(16);function V(){if(!G&&(G=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!G))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return G(k)}const T=[];for(let r=0;r<256;++r)T.push((r+256).toString(16).slice(1));const q=function z(r,s,t){if(Z.randomUUID&&!s&&!r)return Z.randomUUID();const i=(r=r||{}).random||(r.rng||V)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,s){t=t||0;for(let c=0;c<16;++c)s[t+c]=i[c];return s}return function W(r,s=0){return(T[r[s+0]]+T[r[s+1]]+T[r[s+2]]+T[r[s+3]]+"-"+T[r[s+4]]+T[r[s+5]]+"-"+T[r[s+6]]+T[r[s+7]]+"-"+T[r[s+8]]+T[r[s+9]]+"-"+T[r[s+10]]+T[r[s+11]]+T[r[s+12]]+T[r[s+13]]+T[r[s+14]]+T[r[s+15]]).toLowerCase()}(i)};var K=l(127),re=l(9841),o=l(4128),n=l(2084),a=l(1205),d=l(260);let p=(()=>{class r{constructor(){this.isReady=!1,this.isRunning=!1,this.ffmpeg=(0,d.createFFmpeg)({log:!0})}init(){var t=this;return(0,v.Z)(function*(){t.isReady||(yield t.ffmpeg.load(),t.isReady=!0)})()}getScreenshoots(t){var i=this;return(0,v.Z)(function*(){i.isRunning=!0;const c=yield(0,d.fetchFile)(t);i.ffmpeg.FS("writeFile",t.name,c);const _=[1,2,3],N=[];_.forEach(ne=>{N.push("-i",t.name,"-ss",`00:00:0${ne}`,"-frames:v","1","-filter:v","scale=510:-1",`output_0${ne}.png`)}),yield i.ffmpeg.run(...N);const P=[];return _.forEach(ne=>{const X=i.ffmpeg.FS("readFile",`output_0${ne}.png`),ee=new Blob([X.buffer],{type:"image/png"}),te=URL.createObjectURL(ee);P.push(te)}),i.isRunning=!1,P})()}blobFromURL(t){return(0,v.Z)(function*(){return yield(yield fetch(t)).blob()})()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),U=(()=>{class r{handleEvent(t){t.preventDefault()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=e.lG2({type:r,selectors:[["","app-event-blocker",""]],hostBindings:function(t,i){1&t&&e.NdJ("drop",function(_){return i.handleEvent(_)})("dragover",function(_){return i.handleEvent(_)})}}),r})();var O=l(1481);let u=(()=>{class r{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustUrl(t)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(O.H7,16))},r.\u0275pipe=e.Yjl({name:"safeURL",type:r,pure:!0}),r})();function g(r,s){1&r&&(e.ynx(0),e.TgZ(1,"span",5),e._uU(2,"refresh"),e.qZA(),e.TgZ(3,"p",6),e._uU(4,"Loading ..."),e.qZA(),e.BQk())}function m(r,s){1&r&&(e.TgZ(0,"span",5),e._uU(1,"autorenew"),e.qZA())}const E=function(r){return{"bg-indigo-400 border-indigo-400 border-solid":r}};function B(r,s){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",8),e.NdJ("dragend",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.isDragover=!1)})("dragover",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.isDragover=!0)})("dragenter",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.isDragover=!0)})("dragleave",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.isDragover=!1)})("mouseleave",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.isDragover=!1)})("drop",function(c){e.CHM(t);const _=e.oxw(2);return e.KtG(_.storeFile(c))}),e.TgZ(2,"h5"),e._uU(3,"Drop your file here (mp4 only!)"),e.qZA(),e.YNc(4,m,2,0,"span",9),e.qZA(),e.TgZ(5,"input",10),e.NdJ("change",function(c){e.CHM(t);const _=e.oxw(2);return e.KtG(_.storeFile(c))}),e.qZA(),e.BQk()}if(2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(2,E,t.isDragover)),e.xp6(3),e.Q6J("ngIf",t.ffmpegService.isRunning)}}function M(r,s){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"percent"),e.qZA()),2&r){const t=e.oxw(4);e.xp6(1),e.Oqu(e.lcZ(2,1,t.percentage))}}function ie(r,s){if(1&r&&(e.TgZ(0,"app-alert",21)(1,"p"),e._uU(2),e.qZA(),e.YNc(3,M,3,3,"p",22),e.qZA()),2&r){const t=e.oxw(3);e.Q6J("color",t.alertColor),e.xp6(2),e.Oqu(t.alertMsg),e.xp6(1),e.Q6J("ngIf",t.showPercentage)}}const pe=function(r,s){return{"border-green-400":r,"border-transparent":s}};function de(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"div",23),e.NdJ("click",function(){const _=e.CHM(t).$implicit,N=e.oxw(3);return e.KtG(N.selectedScreenshot=_)}),e._UZ(1,"img",24),e.ALo(2,"safeURL"),e.qZA()}if(2&r){const t=s.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.WLB(4,pe,t===i.selectedScreenshot,t!==i.selectedScreenshot)),e.xp6(1),e.Q6J("src",e.lcZ(2,2,t),e.LSH)}}const fe=function(r,s){return{"opacity-50":r,"hover:bg-indigo-700":s}};function ge(r,s){if(1&r){const t=e.EpF();e.YNc(0,ie,4,3,"app-alert",11),e.TgZ(1,"form",12),e.NdJ("ngSubmit",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.uploadFile())}),e.TgZ(2,"h2",13),e._uU(3,"Select a Thumbnail"),e.qZA(),e.TgZ(4,"div",14),e.YNc(5,de,3,7,"div",15),e.qZA(),e.TgZ(6,"div",16)(7,"label",17),e._uU(8,"Title"),e.qZA(),e._UZ(9,"app-input",18),e.qZA(),e.TgZ(10,"div",19)(11,"button",20),e._uU(12," Publish "),e.qZA()()()}if(2&r){const t=e.oxw(2);e.Q6J("ngIf",t.showAlert),e.xp6(1),e.Q6J("formGroup",t.uploadForm),e.xp6(4),e.Q6J("ngForOf",t.screenshots),e.xp6(4),e.Q6J("control",t.title),e.xp6(2),e.Q6J("disabled",t.inSubmission)("ngClass",e.WLB(6,fe,t.inSubmission,!t.inSubmission))}}function me(r,s){if(1&r&&(e.ynx(0),e.YNc(1,B,6,4,"ng-container",3),e.YNc(2,ge,13,9,"ng-template",null,7,e.W1O),e.BQk()),2&r){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",!i.file)("ngIfElse",t)}}let he=(()=>{class r{constructor(t,i,c,_,N){this.storage=t,this.auth=i,this.clipsService=c,this.router=_,this.ffmpegService=N,this.isDragover=!1,this.file=null,this.showAlert=!1,this.alertColor="blue",this.alertMsg="Please wait! Your clip is being uploaded",this.inSubmission=!1,this.percentage=0,this.showPercentage=!1,this.user=null,this.screenshots=[],this.selectedScreenshot="",this.title=new f.NI("",{validators:[f.kI.required,f.kI.minLength(3)],nonNullable:!0}),this.uploadForm=new f.cw({title:this.title}),i.user.subscribe(P=>this.user=P),this.ffmpegService.init()}ngOnDestroy(){this.task?.cancel()}ngOnInit(){}storeFile(t){var i=this;return(0,v.Z)(function*(){if(i.ffmpegService.isRunning)return;i.isDragover=!1;const c=t.dataTransfer?t.dataTransfer?.files.item(0)??null:t.target.files?.item(0);!c||"video/mp4"!==c.type||(i.screenshots=yield i.ffmpegService.getScreenshoots(c),i.file=c,i.title.setValue(c.name.replace(/\.[^/.]+$/,"")),i.selectedScreenshot=i.screenshots[0])})()}uploadFile(){var t=this;return(0,v.Z)(function*(){t.uploadForm.disable(),t.showAlert=!0,t.alertColor="blue",t.alertMsg="Please wait! Your clip is being uploaded",t.inSubmission=!0,t.showPercentage=!0;const i=q(),c=`clips/${i}.mp4`,_=yield t.ffmpegService.blobFromURL(t.selectedScreenshot),N=`screenshots/${i}.png`;t.task=t.storage.upload(c,t.file);const P=t.storage.ref(c);t.screenshotTask=t.storage.upload(N,_);const ne=t.storage.ref(N);var X;(0,re.a)([t.task.percentageChanges(),t.screenshotTask.percentageChanges()]).subscribe(X=>{const[ee,te]=X;ee&&te&&(t.percentage=(ee+te)/200)}),(0,o.D)([t.task.snapshotChanges(),t.screenshotTask.snapshotChanges()]).pipe((0,I.w)(()=>(0,o.D)([P.getDownloadURL(),ne.getDownloadURL()]))).subscribe({next:(X=(0,v.Z)(function*(ee){const[te,ce]=ee,Te={uid:t.user?.uid,displayName:t.user?.displayName,title:t.title.value,fileName:`${i}.mp4`,clipURL:te,screenshotURL:ce,timestamp:K.Z.firestore.FieldValue.serverTimestamp(),screenshotFileName:`${i}.png`},Se=yield t.clipsService.createClip(Te);t.alertMsg="Upload Success!",t.alertColor="green",t.showPercentage=!1,setTimeout(()=>{t.router.navigate(["clip",Se.id])},1e3)}),function(te){return X.apply(this,arguments)}),error:X=>{t.uploadForm.enable(),t.alertMsg="Upload failed! Please try again later!",t.alertColor="red",t.showPercentage=!1,t.inSubmission=!0,console.error(X)}})})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(n.Q1),e.Y36(a.zQ),e.Y36(j.Y),e.Y36(b.F0),e.Y36(p))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-upload"]],decls:7,vars:2,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","flex-col"],[1,"font-bold","mb-6"],[4,"ngIf","ngIfElse"],["uploadEditorCtr",""],[1,"material-icons","text-center","text-6xl","p-8","animate-spin"],[1,"text-center","p-8"],["uploadFormCtr",""],["app-event-blocker","",1,"w-full","px-10","py-40","rounded","text-center","cursor-pointer","border","border-dashed","border-gray-400","transition","duration-500","hover:text-white","hover:bg-indigo-400","hover:border-indigo-400","hover:border-solid","text-xl",3,"ngClass","dragend","dragover","dragenter","dragleave","mouseleave","drop"],["class","material-icons text-center text-6xl p-8 animate-spin",4,"ngIf"],["type","file",1,"mt-4",3,"change"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mb-4","text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","border-8 cursor-pointer",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none",3,"disabled","ngClass"],[3,"color"],[4,"ngIf"],[1,"border-8","cursor-pointer",3,"ngClass","click"],[3,"src"]],template:function(t,i){if(1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._uU(3,"Upload Video"),e.qZA(),e.YNc(4,g,5,0,"ng-container",3),e.YNc(5,me,4,2,"ng-template",null,4,e.W1O),e.qZA()()),2&t){const c=e.MAs(6);e.xp6(4),e.Q6J("ngIf",!i.ffmpegService.isReady)("ngIfElse",c)}},dependencies:[x.mk,x.sg,x.O5,Q.a,Y.w,U,f._Y,f.JL,f.sg,x.Zx,u]}),r})();var ve=l(9635),se=l(4004),ye=l(5698);const ae=(0,se.U)(r=>!!r);let le=(()=>{class r{constructor(t,i){this.router=t,this.auth=i,this.canActivate=(c,_)=>{const N=c.data.authGuardPipe||(()=>ae);return this.auth.user.pipe((0,ye.q)(1),N(c,_),(0,se.U)(P=>"boolean"==typeof P?P:Array.isArray(P)?this.router.createUrlTree(P):this.router.parseUrl(P)))}}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(b.F0),e.LFG(a.zQ))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"any"}),r})();const ue=()=>("/",(0,ve.z)(ae,(0,se.U)(s=>s||"/"))),we=[{path:"manage",component:D,data:{authOnly:!0,authGuardPipe:ue},canActivate:[le]},{path:"upload",component:he,data:{authOnly:!0,authGuardPipe:ue},canActivate:[le]},{path:"manage-clips",redirectTo:"manage"}];let xe=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[b.Bz.forChild(we),b.Bz]}),r})();var Ce=l(4466);let Fe=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[x.ez,xe,Ce.m,f.UX]}),r})()},7854:A=>{var w=function(l){"use strict";var v,x=Object.prototype,b=x.hasOwnProperty,C="function"==typeof Symbol?Symbol:{},e=C.iterator||"@@iterator",j=C.asyncIterator||"@@asyncIterator",L=C.toStringTag||"@@toStringTag";function f(o,n,a){return Object.defineProperty(o,n,{value:a,enumerable:!0,configurable:!0,writable:!0}),o[n]}try{f({},"")}catch{f=function(n,a,d){return n[a]=d}}function J(o,n,a,d){var U=Object.create((n&&n.prototype instanceof R?n:R).prototype),O=new q(d||[]);return U._invoke=function W(o,n,a){var d=Y;return function(U,O){if(d===S)throw new Error("Generator is already running");if(d===h){if("throw"===U)throw O;return re()}for(a.method=U,a.arg=O;;){var u=a.delegate;if(u){var g=oe(u,a);if(g){if(g===F)continue;return g}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(d===Y)throw d=h,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);d=S;var m=Q(o,n,a);if("normal"===m.type){if(d=a.done?h:y,m.arg===F)continue;return{value:m.arg,done:a.done}}"throw"===m.type&&(d=h,a.method="throw",a.arg=m.arg)}}}(o,a,O),U}function Q(o,n,a){try{return{type:"normal",arg:o.call(n,a)}}catch(d){return{type:"throw",arg:d}}}l.wrap=J;var Y="suspendedStart",y="suspendedYield",S="executing",h="completed",F={};function R(){}function D(){}function I(){}var $={};f($,e,function(){return this});var Z=Object.getPrototypeOf,G=Z&&Z(Z(K([])));G&&G!==x&&b.call(G,e)&&($=G);var k=I.prototype=R.prototype=Object.create($);function V(o){["next","throw","return"].forEach(function(n){f(o,n,function(a){return this._invoke(n,a)})})}function T(o,n){function a(U,O,u,g){var m=Q(o[U],o,O);if("throw"!==m.type){var E=m.arg,B=E.value;return B&&"object"==typeof B&&b.call(B,"__await")?n.resolve(B.__await).then(function(M){a("next",M,u,g)},function(M){a("throw",M,u,g)}):n.resolve(B).then(function(M){E.value=M,u(E)},function(M){return a("throw",M,u,g)})}g(m.arg)}var d;this._invoke=function p(U,O){function u(){return new n(function(g,m){a(U,O,g,m)})}return d=d?d.then(u,u):u()}}function oe(o,n){var a=o.iterator[n.method];if(a===v){if(n.delegate=null,"throw"===n.method){if(o.iterator.return&&(n.method="return",n.arg=v,oe(o,n),"throw"===n.method))return F;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return F}var d=Q(a,o.iterator,n.arg);if("throw"===d.type)return n.method="throw",n.arg=d.arg,n.delegate=null,F;var p=d.arg;return p?p.done?(n[o.resultName]=p.value,n.next=o.nextLoc,"return"!==n.method&&(n.method="next",n.arg=v),n.delegate=null,F):p:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,F)}function H(o){var n={tryLoc:o[0]};1 in o&&(n.catchLoc=o[1]),2 in o&&(n.finallyLoc=o[2],n.afterLoc=o[3]),this.tryEntries.push(n)}function z(o){var n=o.completion||{};n.type="normal",delete n.arg,o.completion=n}function q(o){this.tryEntries=[{tryLoc:"root"}],o.forEach(H,this),this.reset(!0)}function K(o){if(o){var n=o[e];if(n)return n.call(o);if("function"==typeof o.next)return o;if(!isNaN(o.length)){var a=-1,d=function p(){for(;++a<o.length;)if(b.call(o,a))return p.value=o[a],p.done=!1,p;return p.value=v,p.done=!0,p};return d.next=d}}return{next:re}}function re(){return{value:v,done:!0}}return D.prototype=I,f(k,"constructor",I),f(I,"constructor",D),D.displayName=f(I,L,"GeneratorFunction"),l.isGeneratorFunction=function(o){var n="function"==typeof o&&o.constructor;return!!n&&(n===D||"GeneratorFunction"===(n.displayName||n.name))},l.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,I):(o.__proto__=I,f(o,L,"GeneratorFunction")),o.prototype=Object.create(k),o},l.awrap=function(o){return{__await:o}},V(T.prototype),f(T.prototype,j,function(){return this}),l.AsyncIterator=T,l.async=function(o,n,a,d,p){void 0===p&&(p=Promise);var U=new T(J(o,n,a,d),p);return l.isGeneratorFunction(n)?U:U.next().then(function(O){return O.done?O.value:U.next()})},V(k),f(k,L,"Generator"),f(k,e,function(){return this}),f(k,"toString",function(){return"[object Generator]"}),l.keys=function(o){var n=[];for(var a in o)n.push(a);return n.reverse(),function d(){for(;n.length;){var p=n.pop();if(p in o)return d.value=p,d.done=!1,d}return d.done=!0,d}},l.values=K,q.prototype={constructor:q,reset:function(o){if(this.prev=0,this.next=0,this.sent=this._sent=v,this.done=!1,this.delegate=null,this.method="next",this.arg=v,this.tryEntries.forEach(z),!o)for(var n in this)"t"===n.charAt(0)&&b.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=v)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(o){if(this.done)throw o;var n=this;function a(g,m){return U.type="throw",U.arg=o,n.next=g,m&&(n.method="next",n.arg=v),!!m}for(var d=this.tryEntries.length-1;d>=0;--d){var p=this.tryEntries[d],U=p.completion;if("root"===p.tryLoc)return a("end");if(p.tryLoc<=this.prev){var O=b.call(p,"catchLoc"),u=b.call(p,"finallyLoc");if(O&&u){if(this.prev<p.catchLoc)return a(p.catchLoc,!0);if(this.prev<p.finallyLoc)return a(p.finallyLoc)}else if(O){if(this.prev<p.catchLoc)return a(p.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<p.finallyLoc)return a(p.finallyLoc)}}}},abrupt:function(o,n){for(var a=this.tryEntries.length-1;a>=0;--a){var d=this.tryEntries[a];if(d.tryLoc<=this.prev&&b.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var p=d;break}}p&&("break"===o||"continue"===o)&&p.tryLoc<=n&&n<=p.finallyLoc&&(p=null);var U=p?p.completion:{};return U.type=o,U.arg=n,p?(this.method="next",this.next=p.finallyLoc,F):this.complete(U)},complete:function(o,n){if("throw"===o.type)throw o.arg;return"break"===o.type||"continue"===o.type?this.next=o.arg:"return"===o.type?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):"normal"===o.type&&n&&(this.next=n),F},finish:function(o){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.finallyLoc===o)return this.complete(a.completion,a.afterLoc),z(a),F}},catch:function(o){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc===o){var d=a.completion;if("throw"===d.type){var p=d.arg;z(a)}return p}}throw new Error("illegal catch attempt")},delegateYield:function(o,n,a){return this.delegate={iterator:K(o),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=v),F}},l}(A.exports);try{regeneratorRuntime=w}catch{"object"==typeof globalThis?globalThis.regeneratorRuntime=w:Function("r","regeneratorRuntime = r")(w)}},7156:A=>{function w(x,b,v,C,e,j,L){try{var f=x[j](L),J=f.value}catch(Q){return void v(Q)}f.done?b(J):Promise.resolve(J).then(C,e)}A.exports=function l(x){return function(){var b=this,v=arguments;return new Promise(function(C,e){var j=x.apply(b,v);function L(J){w(j,C,e,L,f,"next",J)}function f(J){w(j,C,e,L,f,"throw",J)}L(void 0)})}},A.exports.__esModule=!0,A.exports.default=A.exports},3681:A=>{"use strict";A.exports=JSON.parse('{"name":"@ffmpeg/ffmpeg","version":"0.11.6","description":"FFmpeg WebAssembly version","main":"src/index.js","types":"src/index.d.ts","directories":{"example":"examples"},"scripts":{"start":"node scripts/server.js","start:worker":"node scripts/worker-server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","build:worker":"rimraf dist && webpack --config scripts/webpack.config.worker.prod.js","prepublishOnly":"npm run build","lint":"eslint src","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node node_modules/mocha/bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"keywords":["ffmpeg","WebAssembly","video"],"author":"Jerome Wu <jeromewus@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.11.0","@types/emscripten":"^1.39.4","babel-eslint":"^10.1.0","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}')}}]);